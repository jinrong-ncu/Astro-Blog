---
import { getCollection } from "astro:content";
import Layout from "../../layouts/Layout.astro";
import "../../styles/global.css";
import Comments from "../../components/Comments.astro";

export async function getStaticPaths() {
  const posts = await getCollection("blog");
  return posts.map((entry) => ({
    params: { slug: entry.slug },
    props: { entry },
  }));
}

const { entry } = Astro.props;
const { Content } = await entry.render();
---

<Layout title={entry.data.title}>
  <article class="max-w-3xl mx-auto pt-10 pb-20">
    <header class="mb-10 text-center space-y-4">
      <div class="flex justify-center gap-2 mb-6">
        {
          entry.data.tags.map((tag) => (
            <a
              href={`/tags/${tag}`}
              class="inline-flex items-center rounded-full bg-zinc-100 dark:bg-zinc-800 px-3 py-1 text-xs font-medium text-zinc-600 dark:text-zinc-300 hover:bg-zinc-200 dark:hover:bg-zinc-700 transition-colors"
            >
              {tag}
            </a>
          ))
        }
      </div>

      <h1
        class="text-4xl md:text-5xl font-bold tracking-tight text-zinc-900 dark:text-white text-balance"
        transition:name={`title-${entry.slug}`}
      >
        {entry.data.title}
      </h1>

      <div
        class="text-zinc-500 dark:text-zinc-400 flex items-center justify-center gap-2 text-sm"
      >
        <time
          >{
            entry.data.pubDate.toLocaleDateString("zh-CN", {
              year: "numeric",
              month: "long",
              day: "numeric",
            })
          }</time
        >
        <span>Â·</span>
        <span>{entry.data.author}</span>
      </div>
    </header>

    <div
      class="prose prose-zinc prose-lg dark:prose-invert mx-auto prose-headings:font-bold prose-a:text-blue-600 dark:prose-a:text-blue-400 hover:prose-a:text-blue-500"
    >
      <Content />
    </div>
  </article>
  <Comments />
</Layout>
