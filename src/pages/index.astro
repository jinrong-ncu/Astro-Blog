---
import Layout from "../layouts/Layout.astro";
import "../styles/global.css";
import { getCollection } from "astro:content";

// const posts = (await getCollection("blog")).sort(
//   (a: any, b: any) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
// );

const posts = (await getCollection("blog"))
  .filter((post) => !post.data.draft)
  .sort(
    (a: any, b: any) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
  );
---

<Layout title="刘金荣 Blog">
  <section class="space-y-12">
    <div class="space-y-4 max-w-2xl">
      <h1
        class="text-4xl font-bold tracking-tight text-zinc-900 dark:text-white sm:text-5xl"
      >
        书写设计、代码与未来。
      </h1>
      <p class="text-lg text-zinc-500 dark:text-zinc-400 leading-relaxed">
        关于使用 “Vibe Coding”
        原则构建软件的个人思考合集。专注于极简主义、性能和开发体验。
      </p>
    </div>

    <div class="grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
      {
        posts.map((post) => (
          <a
            href={`/blog/${post.slug}`}
            class="group relative flex flex-col space-y-3 bg-white dark:bg-zinc-900 p-6 rounded-2xl border border-zinc-200/50 dark:border-zinc-800 shadow-sm hover:shadow-lg hover:border-zinc-300/50 dark:hover:border-zinc-700 transition-all duration-300 hover:-translate-y-1"
          >
            <div class="flex items-center gap-3 text-xs font-medium text-zinc-400 mb-2">
              <time datetime={post.data.pubDate.toISOString()}>
                {post.data.pubDate.toLocaleDateString("zh-CN", {
                  year: "numeric",
                  month: "long",
                  day: "numeric",
                })}
              </time>
            </div>

            <h2
              class="text-xl font-semibold tracking-tight text-zinc-900 dark:text-zinc-100 group-hover:text-black dark:group-hover:text-white transition-colors"
              transition:name={`title-${post.slug}`}
            >
              {post.data.title}
            </h2>

            <p class="text-zinc-500 dark:text-zinc-400 text-sm leading-relaxed line-clamp-2">
              {post.data.description}
            </p>

            <div class="mt-auto pt-4 flex flex-wrap gap-2">
              {post.data.tags.map((tag) => (
                <span class="inline-flex items-center rounded-md bg-zinc-50 dark:bg-zinc-800 px-2 py-1 text-xs font-medium text-zinc-600 dark:text-zinc-300 ring-1 ring-inset ring-zinc-500/10 dark:ring-zinc-700/50">
                  {tag}
                </span>
              ))}
            </div>
          </a>
        ))
      }
    </div>
  </section>
</Layout>
