---
import Layout from "../layouts/Layout.astro";
import "../styles/global.css";
import { getCollection } from "astro:content";
import { Typewriter } from "../components/Typewriter";

// const posts = (await getCollection("blog")).sort(
//   (a: any, b: any) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
// );

const posts = (await getCollection("blog"))
  .filter((post) => !post.data.draft)
  .sort(
    (a: any, b: any) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
  );
---

<Layout title="刘金荣 Blog">
  <section class="max-w-5xl mx-auto px-6 pt-10 pb-12 relative z-10">
    <div class="space-y-2 relative max-w-3xl">
      <div class="h-8 sm:h-10 flex items-center">
        <p
          class="text-xl sm:text-2xl text-zinc-600 dark:text-zinc-300 font-mono"
        >
          <Typewriter
            client:visible
            text={["书写设计、代码与未来。"]}
            speed={200}
            waitTime={2000}
            deleteSpeed={100}
            cursorChar="|"
          />
        </p>
      </div>
    </div>
  </section>

  <style>
    /* Intentionally empty for now, removed mask-gradient */
  </style>

  <section class="space-y-12 relative z-10">
    <div class="grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
      {
        posts.map((post) => (
          <a
            href={`/blog/${post.slug}`}
            class="group relative flex flex-col space-y-3 bg-white/10 dark:bg-zinc-900/10 p-6 rounded-[24px] backdrop-blur-3xl saturate-200 shadow-[0_4px_24px_rgba(0,0,0,0.05),inset_0_1px_1px_rgba(255,255,255,0.2)] dark:shadow-[0_4px_24px_rgba(0,0,0,0.3),inset_0_1px_1px_rgba(255,255,255,0.05)] transition-all duration-500 transition-spring hover:-translate-y-[5px] hover:bg-white/20 dark:hover:bg-zinc-900/20 hover:shadow-[0_8px_32px_rgba(0,0,0,0.1),inset_0_2px_4px_rgba(255,255,255,0.3)] dark:hover:shadow-[0_8px_32px_rgba(0,0,0,0.4),inset_0_2px_4px_rgba(255,255,255,0.1)]"
          >
            <div class="flex items-center gap-3 text-xs font-medium text-zinc-400 mb-2">
              <time datetime={post.data.pubDate.toISOString()}>
                {post.data.pubDate.toLocaleDateString("zh-CN", {
                  year: "numeric",
                  month: "long",
                  day: "numeric",
                })}
              </time>
            </div>

            <h2
              class="text-xl font-semibold tracking-tight text-zinc-900 dark:text-white group-hover:text-black dark:group-hover:text-white transition-colors"
              transition:name={`title-${post.slug}`}
            >
              {post.data.title}
            </h2>

            <p class="text-zinc-500 dark:text-zinc-400 text-sm leading-relaxed line-clamp-2">
              {post.data.description}
            </p>

            <div class="mt-auto pt-4 flex flex-wrap gap-2">
              {post.data.tags.map((tag) => (
                <span class="inline-flex items-center rounded-md bg-zinc-50 dark:bg-zinc-800 px-2 py-1 text-xs font-medium text-zinc-600 dark:text-zinc-300 ring-1 ring-inset ring-zinc-500/10 dark:ring-zinc-700/50">
                  {tag}
                </span>
              ))}
            </div>
          </a>
        ))
      }
    </div>
  </section>
</Layout>
