---
import Layout from "../layouts/Layout.astro";
import "../styles/global.css";
import { getCollection } from "astro:content";
import { Typewriter } from "../components/Typewriter";

// const posts = (await getCollection("blog")).sort(
//   (a: any, b: any) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
// );

const posts = (await getCollection("blog"))
  .filter((post) => !post.data.draft)
  .sort(
    (a: any, b: any) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
  );
---

<Layout title="刘金荣 Blog">
  <section class="max-w-5xl mx-auto px-6 pt-10 pb-12 overflow-hidden relative">
    <div
      class="absolute inset-x-0 w-[100vw] h-[600px] left-1/2 -translate-x-1/2 top-0 pointer-events-none"
    >
      <div
        class="absolute inset-0 bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-zinc-200/50 via-zinc-100/10 to-transparent dark:from-zinc-800/50 dark:via-zinc-900/10 dark:to-transparent mask-gradient"
      >
      </div>
      <div
        class="absolute inset-0 opacity-[0.25] dark:opacity-[0.15]"
        style="background-size: 24px 24px; background-image: radial-gradient(circle, #52525b 1px, transparent 1px);"
      >
      </div>
    </div>

    <div class="space-y-2 relative max-w-3xl">
      <div class="h-8 sm:h-10 flex items-center">
        <p
          class="text-xl sm:text-2xl text-zinc-600 dark:text-zinc-300 font-mono"
        >
          <Typewriter
            client:visible
            text={["书写设计、代码与未来。"]}
            speed={200}
            waitTime={2000}
            deleteSpeed={100}
            cursorChar="|"
          />
        </p>
      </div>
    </div>
  </section>

  <style>
    .mask-gradient {
      mask-image: linear-gradient(to bottom, black 0%, transparent 100%);
      -webkit-mask-image: linear-gradient(
        to bottom,
        black 0%,
        transparent 100%
      );
    }
  </style>

  <section class="space-y-12">
    <div class="grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
      {
        posts.map((post) => (
          <a
            href={`/blog/${post.slug}`}
            class="group relative flex flex-col space-y-3 bg-white dark:bg-zinc-900 p-6 rounded-2xl border border-zinc-200/50 dark:border-zinc-800 shadow-sm transition-all duration-300 hover:-translate-y-1 hover:shadow-lg hover:border-zinc-300/50 dark:hover:border-zinc-700 hover:shadow-zinc-200/50 dark:hover:shadow-zinc-900/50"
          >
            <div class="flex items-center gap-3 text-xs font-medium text-zinc-400 mb-2">
              <time datetime={post.data.pubDate.toISOString()}>
                {post.data.pubDate.toLocaleDateString("zh-CN", {
                  year: "numeric",
                  month: "long",
                  day: "numeric",
                })}
              </time>
            </div>

            <h2
              class="text-xl font-semibold tracking-tight text-zinc-900 dark:text-zinc-100 group-hover:text-black dark:group-hover:text-white transition-colors"
              transition:name={`title-${post.slug}`}
            >
              {post.data.title}
            </h2>

            <p class="text-zinc-500 dark:text-zinc-400 text-sm leading-relaxed line-clamp-2">
              {post.data.description}
            </p>

            <div class="mt-auto pt-4 flex flex-wrap gap-2">
              {post.data.tags.map((tag) => (
                <span class="inline-flex items-center rounded-md bg-zinc-50 dark:bg-zinc-800 px-2 py-1 text-xs font-medium text-zinc-600 dark:text-zinc-300 ring-1 ring-inset ring-zinc-500/10 dark:ring-zinc-700/50">
                  {tag}
                </span>
              ))}
            </div>
          </a>
        ))
      }
    </div>
  </section>
</Layout>
